<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="de" lang="de">
<head>
	<meta charset="utf-8" />
	<meta http-equiv="content-type" content="text/html; charset=utf-8" />

	<title>$.browserEvent() jQuery plugin</title>
	<meta name="title" content="windowSync() jQuery plugin" />
	<meta name="description" content="Keeping data in multiple browser windows in sync." />
	
	<link rel="stylesheet" type="text/css" href="screen.css" />
	<script type="text/javascript" src="json2.js"></script>
	<script type="text/javascript" src="jquery-1.4.2.min.js"></script>
	<script type="text/javascript" src="jquery.store.js"></script>
	<script type="text/javascript" src="jquery.browserEvent.js"></script>
	<script type="text/javascript">
		
		function log( m, className )
		{
			var t = $( '<p>'+ m +'</p>' ).insertAfter( $(document.body).children().first() );
			if( className )
				t.addClass( className );
		}
		
		var ident = null;
		
		$.storage = new $.store();
		$.storageWindow = new $.store( 'windowName' );

		function initialize()
		{
			$.browserEvent.ready = function()
			{
				ident = this.ident();
				log( 'Initialized $.browserEvent with ident ' + ident, 'info' );
			};
			
			$.browserEvent.bind( 'interWindowMessage', function( e, data )
			{
				log( 'interWindowMessage-event received: ' + data, 'event' );
			}).bind( 'browserWindows', function( e, data )
			{
				log( 'Registered Windows Changed: ' + data.join( ', ' ), 'event' );
			});
			
			$.browserEvent.init( $.storage, $.storageWindow );
			
			
			$.browserEvent.bind( 'someLaterEvent', function( e, data )
			{
				log( 'foobar' );
			});
		}
		
		function send()
		{
			$.browserEvent.trigger( 'interWindowMessage', 'Hello, I am '+ ident +', how are you?' );
		}
	</script>
</head>
<body>
	<div>
		<button onclick="initialize(); return false;" type="button">init</button>
		<button onclick="send(); return false;" type="button">send</button>
	</div>
	<script type="text/javascript">
		document.write( '<p>Initialized <code>$.storage</code> with driver <code>' + $.storage.driver.ident + '</code></p>' );
	</script>
	
	
	<h1>how to test:</h1>
	
	<p class="info">
		Open this page in two browser windows. Align the windows so you can see them simultaneously.
		click [init] in both pages. now click [send] in one window and watch what happens in the other.
	</p>
	<p class="info">Tested with Firefox, Safari, Chrome, IE8 and yes, even IE7</p>
	<p class="info">There's a separate test-page for <a href="store.html">$.store</a></p>
</body>
</html>